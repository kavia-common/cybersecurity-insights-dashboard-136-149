{"is_source_file": true, "format": "Python", "description": "Main backend API implementation for cybersecurity insights dashboard using FastAPI, including user authentication, analytics, threat detection, notifications, dashboard widgets, settings, search, and websocket for real-time notifications.", "external_files": ["fastapi", "fastapi.middleware.cors", "fastapi.security", "pydantic", "typing", "uuid", "datetime"], "external_methods": ["FastAPI", "Depends", "HTTPException", "status", "WebSocket", "WebSocketDisconnect", "CORSMiddleware", "OAuth2PasswordBearer", "OAuth2PasswordRequestForm", "BaseModel", "Field", "EmailStr"], "published": ["/auth/register", "/auth/token", "/auth/me", "/analytics/query", "/threats/query", "/notifications", "/notifications/mark_read", "/widgets/data", "/settings", "/search", "/ws/notifications", "/notifications/push", "/help/websocket"], "classes": [{"name": "UserBase", "description": "Base model for user data containing email."}, {"name": "UserCreate", "description": "Model for user registration, includes email and password."}, {"name": "UserLogin", "description": "Model for user login credentials."}, {"name": "UserResponse", "description": "Model for returning user info, including id and full name."}, {"name": "Token", "description": "Model representing an OAuth2 token with type."}, {"name": "AnalyticsQuery", "description": "Model for querying analytics data with timeframe and filters."}, {"name": "AnalyticsDataPoint", "description": "Represents a single data point in analytics results."}, {"name": "AnalyticsResponse", "description": "Contains list of analytics data points."}, {"name": "ThreatQuery", "description": "Model for querying threats based on timeframe and severity."}, {"name": "ThreatEvent", "description": "Represents a threat detection event with details."}, {"name": "ThreatDetectionResponse", "description": "Contains list of threat events."}, {"name": "Notification", "description": "Model representing a notification or alert."}, {"name": "NotificationResponse", "description": "Contains list of notifications."}, {"name": "WidgetDataRequest", "description": "Request schema for dashboard widget data."}, {"name": "WidgetDataResponse", "description": "Response schema for dashboard widget data."}, {"name": "SettingsUpdate", "description": "Model for updating user/dashboard settings."}, {"name": "UserSettings", "description": "Model for user settings including theme and preferences."}, {"name": "SearchQuery", "description": "Model for search and filtering."}, {"name": "SearchResult", "description": "Individual search result content."}, {"name": "SearchResponse", "description": "Aggregate search results."}], "methods": [{"name": "str fake_hash_password(password: str)", "description": "Simplistic password hashing for demo purposes.", "scope": "", "scopeKind": ""}, {"name": "fake_decode_token(token: str)", "description": "Mock token decoding for authentication.", "scope": "", "scopeKind": ""}, {"name": "UserResponse get_current_user(token: str = Depends(oauth2_scheme))", "description": "Dependency to retrieve current authenticated user based on token.", "scope": "", "scopeKind": ""}, {"name": "create_notification(notification: Notification, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_me(current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_settings(current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "health_check()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_notifications(current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends())", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "mark_notifications_read(ids: List[str], current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "push_notification_to_ws(notification: Notification, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "query_analytics(payload: AnalyticsQuery, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "query_threats(payload: ThreatQuery, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "register_user(user: UserCreate)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "search_items(query: SearchQuery, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "update_settings(settings: SettingsUpdate, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "websocket_help()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "websocket_notifications_endpoint(websocket: WebSocket)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "widget_data(request: WidgetDataRequest, current_user: UserResponse = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["FastAPI", "Depends", "HTTPException", "status", "uuid.uuid4", "datetime.datetime.utcnow", "datetime.timedelta", "websocket.accept", "websocket.receive_text", "websocket.send_json"], "search-terms": ["FastAPI app setup", "WebSocket notifications", "Threat detection API", "Authentications endpoints", "Dashboard widgets", "Real-time notifications", "Security analytics", "Threat events", "User registration", "Token-based auth"], "state": 2, "file_id": 2, "knowledge_revision": 12, "git_revision": "6676800f8ad05dd36d797591e8fedf5174746c44", "revision_history": [{"9": "80d8900fd1bd795025cbdb5a2db47ea017a975e3"}, {"10": "6676800f8ad05dd36d797591e8fedf5174746c44"}, {"11": "6676800f8ad05dd36d797591e8fedf5174746c44"}, {"12": "6676800f8ad05dd36d797591e8fedf5174746c44"}], "ctags": [{"_type": "tag", "name": "ANALYTICS_DATA", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^ANALYTICS_DATA = []$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "AnalyticsDataPoint", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class AnalyticsDataPoint(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AnalyticsQuery", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class AnalyticsQuery(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AnalyticsResponse", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class AnalyticsResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "FAKE_USERS_DB", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^FAKE_USERS_DB = {$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "LIVE_NOTIFICATION_CONNECTIONS", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^LIVE_NOTIFICATION_CONNECTIONS = set()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "NOTIFICATIONS", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^NOTIFICATIONS = []$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Notification", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class Notification(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NotificationResponse", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class NotificationResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SearchQuery", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class SearchQuery(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SearchResponse", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class SearchResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SearchResult", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class SearchResult(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SettingsUpdate", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class SettingsUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "THREAT_EVENTS", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^THREAT_EVENTS = []$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ThreatDetectionResponse", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class ThreatDetectionResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ThreatEvent", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class ThreatEvent(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ThreatQuery", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class ThreatQuery(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Token", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class Token(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserBase", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class UserBase(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserCreate", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class UserCreate(UserBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserLogin", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class UserLogin(UserBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserResponse", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class UserResponse(UserBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserSettings", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class UserSettings(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "WidgetDataRequest", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class WidgetDataRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "WidgetDataResponse", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^class WidgetDataResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_notification", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def create_notification(notification: Notification, current_user: UserResponse = Depends(get_cur/", "language": "Python", "kind": "function", "signature": "(notification: Notification, current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "fake_decode_token", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def fake_decode_token(token: str):$/", "language": "Python", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "fake_hash_password", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def fake_hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "filters", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    filters: Optional[Dict[str, Any]] = Field(None, description=\"Custom filters for analytics da/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "AnalyticsQuery", "scopeKind": "class"}, {"_type": "tag", "name": "filters", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    filters: Optional[Dict[str, Any]] = None$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "SearchQuery", "scopeKind": "class"}, {"_type": "tag", "name": "full_name", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    full_name: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def get_current_user(token: str = Depends(oauth2_scheme)) -> UserResponse:$/", "language": "Python", "typeref": "typename:UserResponse", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme))"}, {"_type": "tag", "name": "get_me", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def get_me(current_user: UserResponse = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "get_settings", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def get_settings(current_user: UserResponse = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "is_active", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    is_active: bool = True$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "list_notifications", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def list_notifications(current_user: UserResponse = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "login_for_access_token", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):$/", "language": "Python", "kind": "function", "signature": "(form_data: OAuth2PasswordRequestForm = Depends())"}, {"_type": "tag", "name": "mark_notifications_read", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def mark_notifications_read(ids: List[str], current_user: UserResponse = Depends(get_current_use/", "language": "Python", "kind": "function", "signature": "(ids: List[str], current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "notifications_enabled", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    notifications_enabled: Optional[bool] = True$/", "language": "Python", "typeref": "typename:Optional[bool]", "kind": "variable", "scope": "SettingsUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/token\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "params", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    params: Optional[Dict[str, Any]] = None$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "WidgetDataRequest", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    password: str = Field(..., min_length=6)$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserCreate", "scopeKind": "class"}, {"_type": "tag", "name": "preferences", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    preferences: Dict[str, Any] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "UserSettings", "scopeKind": "class"}, {"_type": "tag", "name": "preferences", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    preferences: Optional[Dict[str, Any]] = None$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "SettingsUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "push_notification_to_ws", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^async def push_notification_to_ws(notification: Notification, current_user: UserResponse = Depen/", "language": "Python", "kind": "function", "signature": "(notification: Notification, current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "query_analytics", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def query_analytics(payload: AnalyticsQuery, current_user: UserResponse = Depends(get_current_us/", "language": "Python", "kind": "function", "signature": "(payload: AnalyticsQuery, current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "query_threats", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def query_threats(payload: ThreatQuery, current_user: UserResponse = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(payload: ThreatQuery, current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "read", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    read: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Notification", "scopeKind": "class"}, {"_type": "tag", "name": "register_user", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def register_user(user: UserCreate):$/", "language": "Python", "kind": "function", "signature": "(user: UserCreate)"}, {"_type": "tag", "name": "search_items", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def search_items(query: SearchQuery, current_user: UserResponse = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(query: SearchQuery, current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "severity", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    severity: Optional[str] = Field(None, description=\"Severity level filter (e.g., high, medium/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ThreatQuery", "scopeKind": "class"}, {"_type": "tag", "name": "theme", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    theme: Optional[str] = Field(None, description=\"UI theme, e.g., 'light' or 'dark'\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "SettingsUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "timeframe", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    timeframe: str = Field(..., description=\"Time window for analytics (e.g., '24h', '7d')\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "AnalyticsQuery", "scopeKind": "class"}, {"_type": "tag", "name": "timeframe", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    timeframe: str = Field(..., description=\"Time window for threat search\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ThreatQuery", "scopeKind": "class"}, {"_type": "tag", "name": "types", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^    types: Optional[List[str]] = Field(None, description=\"Which data types (threats, notificatio/", "language": "Python", "typeref": "typename:Optional[List[str]]", "kind": "variable", "scope": "SearchQuery", "scopeKind": "class"}, {"_type": "tag", "name": "update_settings", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def update_settings(settings: SettingsUpdate, current_user: UserResponse = Depends(get_current_u/", "language": "Python", "kind": "function", "signature": "(settings: SettingsUpdate, current_user: UserResponse = Depends(get_current_user))"}, {"_type": "tag", "name": "websocket_help", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def websocket_help():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "websocket_notifications_endpoint", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^async def websocket_notifications_endpoint(websocket: WebSocket):$/", "language": "Python", "kind": "function", "signature": "(websocket: WebSocket)"}, {"_type": "tag", "name": "widget_data", "path": "/home/kavia/workspace/code-generation/cybersecurity-insights-dashboard-136-149/backend/src/api/main.py", "pattern": "/^def widget_data(request: WidgetDataRequest, current_user: UserResponse = Depends(get_current_use/", "language": "Python", "kind": "function", "signature": "(request: WidgetDataRequest, current_user: UserResponse = Depends(get_current_user))"}], "hash": "fbbb0a75602461189e4075e188aa944d", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/main.py", "fields": [{"name": "ANALYTICS_DATA = []", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "FAKE_USERS_DB = {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "LIVE_NOTIFICATION_CONNECTIONS = set()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "NOTIFICATIONS = []", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "THREAT_EVENTS = []", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str, Any]] filters", "scope": "AnalyticsQuery", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] full_name", "scope": "UserResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_active", "scope": "UserResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[bool] notifications_enabled", "scope": "SettingsUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/token\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str, Any]] params", "scope": "WidgetDataRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str password", "scope": "UserCreate", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, Any] preferences", "scope": "UserSettings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[Dict[str, Any]] preferences", "scope": "SettingsUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "bool read", "scope": "Notification", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] severity", "scope": "ThreatQuery", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] theme", "scope": "SettingsUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "str timeframe", "scope": "AnalyticsQuery", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[List[str]] types", "scope": "SearchQuery", "scopeKind": "class", "description": "unavailable"}]}